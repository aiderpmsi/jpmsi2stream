<?xml version="1.0" encoding="UTF-8" ?>

<tree xmlns:dflt="http://default.actions/default" >

	<dflt:assign var="lineNumber" expr="1" />
	<dflt:assign var="lineNumberElement" expr="lb.createLine('lineNumber')" />

	<dflt:switch cond="start eq 'rsfheader'" >
		<dflt:goto dest="rsf" />
	</dflt:switch>

	<dflt:switch cond="start eq 'rssheader'" >
		<dflt:goto dest="rss" />
	</dflt:switch>

	<!-- CHECK IF THIS IS A RSS OR RSF -->
	<dflt:assign var="rsf2012header" expr="lb.createLine('rsf2012header')" />
	<dflt:switch cond="utils.isFound(rsf2012header)" >
		<dflt:goto dest="withrsf" />
	</dflt:switch>
	<dflt:assign var="rss116header" expr="lb.createLine('rss116header')" />
	<dflt:switch cond="utils.isFound(rss116header)" >
		<dflt:goto dest="withrss" />
	</dflt:switch>

	<!-- CHECK IF IT IS A RSF -->
	<dflt:assign id="rsf" var="rsf2012header" expr="lb.createLine('rsf2012header')" />
	<dflt:switch cond="utils.isFound(rsf2012header)" >
		<dflt:assign id="withrsf" var="rsf2012a" expr="lb.createLine('rsf2012a')" />
		<dflt:assign var="rsf2012b" expr="lb.createLine('rsf2012b')" />
		<dflt:assign var="rsf2012c" expr="lb.createLine('rsf2012c')" />
		<dflt:assign var="rsf2012h" expr="lb.createLine('rsf2012h')" />
		<dflt:assign var="rsf2012i" expr="lb.createLine('rsf2012i')" />
		<dflt:assign var="rsf2012l" expr="lb.createLine('rsf2012l')" />
		<dflt:assign var="rsf2012m" expr="lb.createLine('rsf2012m')" />
		<dflt:assign var="eof" expr="lb.createLine('eof')" />

		<dflt:execute expr="utils.handleLineNumber(lineNumber, lineNumberElement)" />
		<dflt:assign var="lineNumber" expr="lineNumber + 1" />
		<dflt:execute expr="utils.handleLine(rsf2012header)" />
		
		<dflt:execute id="startrsf" expr="utils.handleLineNumber(lineNumber, lineNumberElement)" />
		<dflt:assign var="lineNumber" expr="lineNumber + 1" />

		<dflt:switch cond="utils.isFound(rsf2012a)" >
			<dflt:execute expr="utils.handleLine(rsf2012a)" />
			<dflt:goto dest="startrsf" />
		</dflt:switch>
	
		<dflt:switch cond="utils.isFound(rsf2012b)" >
			<dflt:execute expr="utils.handleLine(rsf2012b)" />
			<dflt:goto dest="startrsf" />
		</dflt:switch>

		<dflt:switch cond="utils.isFound(rsf2012c)" >
			<dflt:execute expr="utils.handleLine(rsf2012c)" />
			<dflt:goto dest="startrsf" />
		</dflt:switch>

		<dflt:switch cond="utils.isFound(rsf2012h)" >
			<dflt:execute expr="utils.handleLine(rsf2012h)" />
			<dflt:goto dest="startrsf" />
		</dflt:switch>

		<dflt:switch cond="utils.isFound(rsf2012i)" >
			<dflt:execute expr="utils.handleLine(rsf2012i)" />
			<dflt:goto dest="startrsf" />
		</dflt:switch>

		<dflt:switch cond="utils.isFound(rsf2012l)" >
			<dflt:execute expr="utils.handleLine(rsf2012l)" />
			<dflt:goto dest="startrsf" />
		</dflt:switch>

		<dflt:switch cond="utils.isFound(rsf2012m)" >
			<dflt:execute expr="utils.handleLine(rsf2012m)" />
			<dflt:goto dest="startrsf" />
		</dflt:switch>

		<dflt:switch cond="utils.isFound(eof)" >
			<dflt:execute expr="utils.handleLine(eof)" />
		</dflt:switch>
		
		<dflt:execute expr="utils.noLineError('rsfa, rsfb, rsfc, rsfh, rsfi, rsfl, rsfm', lineNumber)">
			<dflt:execute expr="" />
		</dflt:execute>

	</dflt:switch>
	<dflt:execute expr="utils.noHeaderError(lineNumber)">
		<dflt:execute expr="" />
	</dflt:execute>

	<!-- CHECK IF IT IS A RSS -->	
	<dflt:assign id="rss" var="rss116header" expr="lb.createLine('rss116header')" />
	<dflt:switch cond="utils.isFound(rss116header)" >
		<dflt:assign id="withrss" var="rss116main" expr="lb.createLine('rss116main')" />
		<dflt:assign var="rss116da" expr="lb.createLine('rss116da')" />
		<dflt:assign var="rss116dad" expr="lb.createLine('rss116dad')" />
		<dflt:assign var="rss116za" expr="lb.createLine('rss116za')" />
		<dflt:assign var="eof" expr="lb.createLine('eof')" />

		<dflt:execute expr="utils.handleLineNumber(lineNumber, lineNumberElement)" />
		<dflt:assign var="lineNumber" expr="lineNumber + 1" />
		<dflt:execute expr="utils.handleLine(rss116header)" />

		<dflt:switch id="rssstart" cond="utils.isFound(rss116main)" >

			<dflt:execute expr="utils.handleLineNumber(lineNumber, lineNumberElement)" />
			<dflt:assign var="lineNumber" expr="lineNumber + 1" />

			<dflt:execute expr="utils.handleLine(rss116main)" />
			<dflt:assign var="nbda" expr="utils.getElementLineAsInt(rss116main, 'NbDA')" />
			<dflt:assign var="nbdad" expr="utils.getElementLineAsInt(rss116main, 'NbDAD')" />
			<dflt:assign var="nbza" expr="utils.getElementLineAsInt(rss116main, 'NbZA')" />
			<dflt:assign var="nbdaread" expr="0" />
			<dflt:assign var="nbdadread" expr="0" />
			<dflt:assign var="nbzaread" expr="0" />
			
			<dflt:switch id="rssda" cond="nbdaread lt nbda" >
				<dflt:switch cond="utils.isFound(rss116da)" >
					<dflt:execute expr="utils.handleLine(rss116da)" />
					<dflt:assign var="nbdaread" expr="nbdaread + 1" />
					<dflt:goto dest="rssda"/>
				</dflt:switch>
				<dflt:execute expr="utils.noLineError('da element', lineNumber)">
					<dflt:execute expr="" />
				</dflt:execute>
			</dflt:switch>

			<dflt:switch id="rssdad" cond="nbdadread lt nbdad" >
				<dflt:switch cond="utils.isFound(rss116dad)" >
					<dflt:execute expr="utils.handleLine(rss116dad)" />
					<dflt:assign var="nbdadread" expr="nbdadread + 1" />
					<dflt:goto dest="rssdad"/>
				</dflt:switch>
				<dflt:execute expr="utils.noLineError('dad element', lineNumber)">
					<dflt:execute expr="" />
				</dflt:execute>
			</dflt:switch>
			
			<dflt:switch id="rssza" cond="nbzaread lt nbza" >
				<dflt:switch cond="utils.isFound(rss116za)" >
					<dflt:execute expr="utils.handleLine(rss116za)" />
					<dflt:assign var="nbzaread" expr="nbzaread + 1" />
					<dflt:goto dest="rssza"/>
				</dflt:switch>
				<dflt:execute expr="utils.noLineError('za element', lineNumber)">
					<dflt:execute expr="" />
				</dflt:execute>
			</dflt:switch>

			<!-- NOTHING MORE TO READ, RESTART -->
			<dflt:goto dest="rssstart"/>

		</dflt:switch>

		<dflt:switch cond="utils.isFound(eof)" >
			<dflt:execute expr="utils.handleLine(eof)" />
		</dflt:switch>

		<dflt:execute expr="utils.noLineError('rss116 element', lineNumber)">
			<dflt:execute expr="" />
		</dflt:execute>

	</dflt:switch>
	<dflt:execute expr="utils.noHeaderError(linenumber)">
		<dflt:execute expr="" />
	</dflt:execute>

</tree>